<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.23">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jason Collins">
<meta name="dcterms.date" content="2014-11-19">

<title>Genetics and education policy – Jason Collins blog</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-226bd0f977fa82dfae4534cac220d79a.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-ac706bccb5107cfdbcdabb2cff0da72d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-C50MEPDMZ9"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-C50MEPDMZ9', { 'anonymize_ip': true});
</script>


<link rel="stylesheet" href="../styles.css">
<meta property="og:title" content="Genetics and education policy – Jason Collins blog">
<meta property="og:description" content="Behavioural economics, data science and artificial intelligence.">
<meta property="og:site_name" content="Jason Collins blog">
<meta name="twitter:title" content="Genetics and education policy – Jason Collins blog">
<meta name="twitter:description" content="Behavioural economics, data science and artificial intelligence.">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Jason Collins blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../research.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../subscribe.html"> 
<span class="menu-text">Subscribe</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../teaching.html"> 
<span class="menu-text">Teaching</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Genetics and education policy</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jason Collins </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 19, 2014</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>Philip Ball has an article in the <a href="http://www.prospectmagazine.co.uk/opinions/there-is-no-gene-for-everything">December issue of Prospect</a> (<a href="http://philipball.blogspot.com.au/2014/11/the-gene-delusion.html">ungated on his blog</a>) arguing that consideration of the genetic basis to social problems is a distraction from socioeconomic causes. The strawman punchline for the Prospect article is “It’s delusional to believe that everything can be explained by genetics”.</p>
<p>The article has drawn <a href="http://dominiccummings.wordpress.com/2014/11/13/low-quality-journalism-from-prospect-on-the-sensitive-subject-of-genes-and-iq/">a response</a> from one of the people named in the article, Dominic Cummings. Ball suggests&nbsp;that Cummings presents “genetics as a fait accompli – if you don’t have the right genes, nothing much will help”, although this statement suggests Ball had not invested much effort getting across Cummings’s actual position (as contained in <a href="http://dominiccummings.files.wordpress.com/2013/11/20130825-some-thoughts-on-education-and-political-priorities-version-2-final.pdf">this now infamous essay</a>). <a href="http://philipball.blogspot.com.au/2014/11/genes-and-iq-as-touchy-as-id-expected.html">Ball responded</a>&nbsp;in turn, with <a href="http://dominiccummings.wordpress.com/2014/11/13/low-quality-journalism-from-prospect-on-the-sensitive-subject-of-genes-and-iq/">Cummings firing back</a>&nbsp;(in an update at the bottom of the page), and <a href="http://philipball.blogspot.com.au/2014/11/genes-and-iq-some-clarifications.html">Ball responding again</a>.</p>
<p>Beyond&nbsp;the tit for tat - read their respective posts for that - there are some interesting points&nbsp;about&nbsp;whether genetics tells us anything about education policy.</p>
<p>As a start, Ball claims that “Social class remains the strongest predictor of educational achievement in the UK”, referencing <a href="http://www.thersa.org/__data/assets/pdf_file/0019/367003/RSA-Social-Justice-paper.pdf">this article</a>.&nbsp;However, the authors of that article&nbsp;don’t consider the role of genetics or other potential predictors. The references that article gives for the claim are similarly devoid of relevant comparisons, which is unsurprising as they&nbsp;largely comprise policy positioning documents from various organisations. It’s hard to credibly claim something is a superior predictor when it is not assessed&nbsp;against the alternatives.</p>
<p>So, what is the evidence on this point? For one, we have twin and adoption studies. As a sample,&nbsp;<a href="http://qje.oxfordjournals.org/content/122/1/119.abstract">Bruce Sacerdote studied</a> Korean adoptees into the United States (admittedly, not the UK as per the quote) and found that shared environment (which would include socioeconomic status) explained 16 per cent of the variation in educational attainment. Genetic factors explained 44 per cent. This is a consistent finding in adoption studies, with children more closely resembling their biological parents than their adopted parents.&nbsp;For twin studies, <a href="http://link.springer.com/article/10.1007%2FBF02359887">an Australian analysis</a> found a&nbsp;57 per cent genetic and 24 per cent shared environment contribution to variation in&nbsp;education.&nbsp;<a href="http://connection.ebscohost.com/c/articles/95750462/variation-heritability-educational-attainment-international-meta-analysis">A meta-analysis</a> of heritability estimates of educational attainment found that, in the majority of samples, genetic variation explained more of the variation in educational attainment than shared environment.</p>
<p>Of course, we don’t have the genetic data or understanding at hand just yet, but there are other factors such as IQ that are better predictors of education than social class. This territory is also&nbsp;complicated&nbsp;- there are genetic effects on both IQ and social class - but IQ tends to outperform. <a href="http://www.sciencedirect.com/science/article/pii/S0160289606001127">This meta-analysis</a> shows that IQ is a better predictor of education, income and occupation than socioeconomic status - not overwhelmingly so, but superior nonetheless.</p>
<p>Then there is the link between genetic factors and socioeconomic status, with a long line of studies finding&nbsp;a relationship.&nbsp;One of the more recent was&nbsp;<a href="http://doi.org/10.1146/annurev-economics-080511-110939">by Daniel Benjamin and friends</a>&nbsp;(<a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC3592970/pdf/nihms-394440.pdf">ungated pdf</a>). They&nbsp;found heritability of permanent income (20-year average) of 0.58 for men and 0.46 for women. Part of the predictive power of socioeconomic status comes from its genetic basis. <a href="https://www.jasoncollins.blog/the-genetic-basis-of-social-mobility/">Gregory Clark’s hypothesis of low social mobility being a result of genetic factors</a>&nbsp;reflects this body of work.</p>
<p>Turning next to Ball’s pessimism of the future of genetics, he states:</p>
<blockquote class="blockquote">
<p>In September an international consortium led by Daniel Benjamin of Cornell University in New York reported on a search for genes linked to cognitive ability using a new statistical method that overcomes the weaknesses of traditional surveys. The method cross-checks such putative associations against a “proxy phenotype” – a trait that can ‘stand in’ for the one being probed. In this case the proxy for cognitive performance was the number of years that the tens of thousands of test subjects spent in education.</p>
From several intelligence-linked genes claimed in previous work, only three survived this scrutiny. More to the point, those three were able to account for only a tiny fraction of the inheritable differences in IQ. Someone blessed with two copies of all three of the “favourable” gene variants could expect a boost of just 1.8 IQ points relative to someone with none of these variants. As the authors themselves admitted, the three gene variants are “not useful for predicting any particular individual’s performance because the effect sizes are far too small”.
</blockquote>
<p>This, however, is only part of the picture. If we look at <a href="http://www.sciencemag.org/content/340/6139/1467">another study&nbsp;in which&nbsp;Benjamin was involved</a>, three SNPs (single nucleotide polymorphisms - single base changes in the DNA code) were found to&nbsp;affect educational attainment. In total, they explained 0.02 per cent of the variation in educational attainment - practically nothing. But combine all the SNPs in the 100,000 person sample, and you edge up to 2.5 per cent. But even more interesting,&nbsp;they calculated that with a large enough sample they could explain over 20 per cent of the variation. Co-author&nbsp;Philipp Koellinger&nbsp;explains this <a href="https://www.jasoncollins.blog/genome-wide-association-studies-and-socioeconomic-outcomes/">in a video I recently linked</a>. Although this study found variants&nbsp;with&nbsp;low explanatory power, it also points to the potential to explain much more&nbsp;with larger samples.</p>
<p>For more on the background to the feasibility of identifying the causal genetic variants for traits such as IQ, its worth looking at <a href="http://arxiv.org/abs/1408.3421">this paper by Steve Hsu</a>. Possibly the most important point is that the causal variants for traits such as cognitive ability and height are additive in their effect. In his final response, Ball states that “And that might be because we are thinking the wrong way – too linearly – about how many if not most genes actually operate.” But the evidence shows that is how they largely work. Although a few years old now, <a href="http://www.plosgenetics.org/article/info:doi/10.1371/journal.pgen.1000008">this paper’s</a>&nbsp;theoretical and empirical argument&nbsp;that genetic effects are largely additive has generally been affirmed in later research.&nbsp;This considerably simplifies the task of predicting outcomes based on someone’s genome. In fact, this is one&nbsp;reason selective breeding has been so successful and genetic data <a href="http://infoproc.blogspot.com.au/2014/08/its-all-in-gene-cows.html">is already being used successfully in cattle breeding</a> (There’s an example of the gap between entrepreneurship and policy development - while some of us are arguing whether this stuff is possible, someone else is already doing it).</p>
<p>Now, supposing you have this genetic data, how might this change education? Returning&nbsp;<a href="http://doi.org/10.1146/annurev-economics-080511-110939">to the article I linked above</a>&nbsp;(<a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC3592970/pdf/nihms-394440.pdf">ungated pdf</a>), Benjamin and friends&nbsp;suggested this genetic information could be used to better target interventions. They propose&nbsp;early identification of dyslexia as an example.</p>
<p>They also suggest using genetic data as controls. This could provide&nbsp;more precision in studies&nbsp;of&nbsp;whether interventions to target socioeconomically disadvantaged children are effective. The genetic controls allow you to hone in on what you are interested in.&nbsp;In the question and answer session of a <a href="https://www.jasoncollins.blog/genome-wide-association-studies-and-socioeconomic-outcomes/">video of talk by Jason Fletcher</a> I recently linked, Benjamin pointed to the famous <a href="http://en.wikipedia.org/wiki/HighScope">Perry PreSchool Project</a> and noted that additional precision through the use of&nbsp;genetic data would have been of great value.</p>
<p>Ball also indirectly alludes to another reason to learn about genetic factors. In <a href="http://philipball.blogspot.com.au/2014/11/genes-and-iq-some-clarifications.html">his last response</a>, he writes:</p>
<blockquote class="blockquote">
Personally, I find a little chilling the idea that we might try to predict children’s attainments by reading their genome, and gear their education accordingly – not least because we know (and Plomin would of course acknowledge this) that genes operate in conjunction with their environment, and so whatever genetic hand you have been dealt, its outcomes are contingent on experience.
</blockquote>
<p>This argument runs both ways. Supposing there are large gene-environment interactions, how can you understand the effects of changing the environment without looking at the way that environment affects people via their genome? As an example of this, <a href="http://www.plosone.org/article/info%3Adoi%2F10.1371%2Fjournal.pone.0050576">Jason Fletcher examined</a> how variation in a gene changed the response to tobacco taxation policy (he talks about this&nbsp;<a href="https://www.jasoncollins.blog/genome-wide-association-studies-and-socioeconomic-outcomes/">in a video I recently linked</a>). Those with a certain allele responded to taxation and reduced smoking. Others didn’t. Too be honest, I’m not sold on the results of this particular study, but it illustrates that genetic&nbsp;factors that need to be considered if these gene-environment interactions are as large as people such as Ball believe.</p>
<p>[I should admit at this point that <em>G is for Genes: The Impact of Genetics on Education and Achievement</em>&nbsp;is sitting unread in my reading pile….]</p>
<p>Putting it together, Ball is off track in his suggestion that learning about and targeting genetic factors distracts&nbsp;from dealing with socioeconomic issues. Understanding of genetic and socioeconomic factors&nbsp;are complements, and by disentangling their effects,&nbsp;we could better tailor education to address each.</p>
<p>That is not to say that the genetic&nbsp;enterprise is guaranteed to be&nbsp;successful. But there is plenty of evidence that our&nbsp;genes are relevant&nbsp;and, on that basis, should be considered.</p>
<p>Further,&nbsp;there are changes we can make today.&nbsp;Ball asks what genetics can add beyond recognition that some children are more talented than others. The thing is, much schooling is still structured as though&nbsp;we are blank slates. Maybe it is an understanding of genetics that will finally&nbsp;get us to a point where education is better designed for&nbsp;people with&nbsp;different capacities, improving the experience across the full range of abilities and backgrounds.</p>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/www\.jasoncollins\.blog");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="light">
<script>
function loadGiscusWhenReady() {
  // Function to get the theme based on body class
  const getTheme = () => {
    const baseTheme = document.getElementById('giscus-base-theme').value;
    const altTheme = document.getElementById('giscus-alt-theme').value;
    return document.body.classList.contains('quarto-dark') ? altTheme : baseTheme;
  };
  // Create the Giscus script and add it to the desired location
  const loadGiscus = () => {
    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.async = true;
    script.dataset.repo = "jasonacollins/jasoncollinsblog";
    script.dataset.repoId = "R_kgDOIbjYgQ";
    script.dataset.category = "Announcements";
    script.dataset.categoryId = "DIC_kwDOIbjYgc4CSiuB";
    script.dataset.mapping = "pathname";
    script.dataset.reactionsEnabled = "0";
    script.dataset.emitMetadata = "0";
    script.dataset.inputPosition = "bottom";
    script.dataset.theme = getTheme();
    script.dataset.lang = "en";
    script.crossOrigin = "anonymous";
    // Append the script to the desired div instead of at the end of the body
    document.getElementById("quarto-content").appendChild(script);
  };
  // MutationObserver to detect when the 'quarto-light' or 'quarto-dark' class is added to the body
  const observer = new MutationObserver((mutations) => {
    for (const mutation of mutations) {
      if (mutation.type === "attributes" && mutation.attributeName === "class") {
        if (document.body.classList.contains('quarto-light') || document.body.classList.contains('quarto-dark')) {
          loadGiscus();
          observer.disconnect(); // Stop observing once Giscus is loaded
          break;
        }
      }
    }
  });
  // Start observing the body for class attribute changes
  observer.observe(document.body, {
    attributes: true,
    attributeFilter: ["class"],
  });
}
loadGiscusWhenReady();
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://creativecommons.org/licenses/by/4.0/">
<p>Copyright: CC-BY</p>
</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>